# Инструкция по деплою на Render

## Шаг 1: Подготовка репозитория

✅ Все файлы уже готовы:
- `render.yaml` - конфигурация для Render
- `main.py` - обновлен для работы с переменной PORT
- `requirements.txt` - все зависимости указаны

## Шаг 2: Создание сервиса на Render

1. **Войдите в Render:**
   - Перейдите на https://render.com
   - Войдите через GitHub (используйте ваш аккаунт Gzbw)

2. **Создайте новый Web Service:**
   - Нажмите "New +" → "Web Service"
   - Выберите репозиторий: `Gzbw/clinical-ai-backend`
   - Или подключите репозиторий, если его нет в списке

3. **Настройки сервиса:**
   - **Name:** `clinical-ai-backend` (или любое другое)
   - **Environment:** `Python 3`
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `uvicorn main:app --host 0.0.0.0 --port $PORT`
   - **Plan:** Выберите Free или другой план

4. **Переменные окружения:**
   Добавьте следующие переменные в разделе "Environment Variables":
   
   ```
   GEMINI_API_KEY=AIzaSyA3u5n0w6TLz_2_Y0CPhAmx6teQ9UOTkXA
   OPENAI_API_KEY=ваш_openai_ключ_здесь
   ```
   
   ⚠️ **Важно:** Не добавляйте `.env` файл в репозиторий! Используйте только переменные окружения в Render.

5. **Автоматический деплой:**
   - Render автоматически определит настройки из `render.yaml`
   - Или настройте вручную как указано выше

6. **Нажмите "Create Web Service"**

## Шаг 3: Ожидание деплоя

- Render начнет сборку и деплой автоматически
- Процесс займет 2-5 минут
- Вы увидите логи сборки в реальном времени

## Шаг 4: Проверка работы

После успешного деплоя:
1. Render предоставит URL вида: `https://clinical-ai-backend.onrender.com`
2. Откройте этот URL в браузере
3. Проверьте работу сайта

## Важные моменты

### Переменные окружения
- `GEMINI_API_KEY` - ваш ключ Google Gemini API
- `OPENAI_API_KEY` - ваш ключ OpenAI API (если используете)
- `PORT` - автоматически устанавливается Render (не нужно добавлять вручную)

### Статические файлы
- Статические файлы (HTML, CSS, JS) будут доступны через FastAPI
- Путь: `https://your-app.onrender.com/static/index.html`

### Автоматические деплои
- Render автоматически деплоит при каждом push в ветку `main`
- Можно настроить деплой из других веток в настройках

### Логи
- Все логи доступны в панели Render
- Можно просматривать логи в реальном времени

## Решение проблем

### Ошибка "Module not found"
- Убедитесь, что все зависимости в `requirements.txt`
- Проверьте логи сборки

### Ошибка "Port already in use"
- Убедитесь, что используете переменную `$PORT` в start command
- Проверьте, что `main.py` использует `os.getenv("PORT", 8000)`

### Ошибка "API key not found"
- Проверьте, что переменные окружения добавлены в Render
- Убедитесь, что названия переменных совпадают (GEMINI_API_KEY, OPENAI_API_KEY)

### Сайт не открывается
- Проверьте логи в панели Render
- Убедитесь, что сервис запущен (Status: Live)
- Проверьте URL - он должен быть вида `https://your-app.onrender.com`

## Обновление сайта

После каждого изменения в коде:
1. Сделайте commit и push в GitHub
2. Render автоматически начнет новый деплой
3. Дождитесь завершения (обычно 2-5 минут)

## Стоимость

- **Free план:** Бесплатно, но сервис "засыпает" после 15 минут бездействия
- **Starter план:** $7/месяц - сервис всегда активен

---

**Готово!** Ваш сайт будет доступен по адресу, который предоставит Render.

